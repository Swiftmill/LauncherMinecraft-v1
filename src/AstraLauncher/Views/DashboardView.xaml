<UserControl x:Class="AstraLauncher.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="900">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Background="{DynamicResource GlassBackground}" CornerRadius="20" Padding="24">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="300" />
                </Grid.ColumnDefinitions>

                <StackPanel Spacing="16">
                    <TextBlock Text="Bienvenue" FontSize="32" FontWeight="SemiBold" Foreground="{DynamicResource PrimaryText}" />
                    <TextBlock Text="Retrouvez vos mondes et versions Minecraft préférés" Foreground="{DynamicResource SecondaryText}" />

                    <Border Background="{DynamicResource AccentGradientBrush}" CornerRadius="24" Padding="24">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Profil actif" Foreground="White" Opacity="0.8" />
                            <TextBlock Text="{Binding ActiveProfile.Name}" FontSize="24" FontWeight="SemiBold" Foreground="White" />
                            <TextBlock Text="{Binding ActiveProfile.Version}" Foreground="White" Opacity="0.8" />
                            <Button Content="JOUER" Command="{Binding PlayCommand}"
                                    Style="{DynamicResource PrimaryButtonStyle}" Height="48" />
                        </StackPanel>
                    </Border>

                    <StackPanel>
                        <TextBlock Text="Profils" FontSize="18" FontWeight="SemiBold" Margin="0,16,0,8" />
                        <ItemsControl ItemsSource="{Binding Profiles}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel ItemWidth="260" ItemHeight="120" Margin="0,0,0,0" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,0,16,16" Padding="16" Background="{DynamicResource GlassBackground}" CornerRadius="18">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold" />
                                            <TextBlock Text="{Binding Version}" Foreground="{DynamicResource SecondaryText}" />
                                            <TextBlock Text="{Binding Loader}" Foreground="{DynamicResource SecondaryText}" />
                                            <Button Content="Sélectionner" Margin="0,12,0,0" Style="{DynamicResource SecondaryButtonStyle}"
                                                    Command="{Binding DataContext.SelectProfileCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}"
                                                    CommandParameter="{Binding}" />
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="1" Spacing="16">
                    <Border Background="{DynamicResource GlassBackground}" CornerRadius="18" Padding="16">
                        <StackPanel Spacing="8">
                            <TextBlock Text="Comptes" FontWeight="SemiBold" />
                            <ItemsControl ItemsSource="{Binding DataContext.Accounts, RelativeSource={RelativeSource AncestorType=Window}}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#1FFFFFFF" CornerRadius="12" Padding="12" Margin="0,0,0,8">
                                            <StackPanel>
                                                <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" />
                                                <TextBlock Text="{Binding XboxGamertag}" Foreground="{DynamicResource SecondaryText}" />
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Button Content="Se connecter" Command="{Binding SignInCommand}" Style="{DynamicResource SecondaryButtonStyle}" />
                        </StackPanel>
                    </Border>

                    <Border Background="{DynamicResource GlassBackground}" CornerRadius="18" Padding="16">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Actualités Minecraft" FontWeight="SemiBold" />
                            <ItemsControl ItemsSource="{Binding MinecraftNews}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="0,0,0,12">
                                            <TextBlock Text="{Binding Title}" FontWeight="SemiBold" />
                                            <TextBlock Text="{Binding Content}" TextWrapping="Wrap" Foreground="{DynamicResource SecondaryText}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>

                    <Border Background="{DynamicResource GlassBackground}" CornerRadius="18" Padding="16">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Actualités Launcher" FontWeight="SemiBold" />
                            <ItemsControl ItemsSource="{Binding LauncherNews}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="0,0,0,12">
                                            <TextBlock Text="{Binding Title}" FontWeight="SemiBold" />
                                            <TextBlock Text="{Binding Content}" TextWrapping="Wrap" Foreground="{DynamicResource SecondaryText}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <Border Grid.Row="1" Background="#66000000" Visibility="{Binding IsUpdateDialogOpen, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border CornerRadius="24" Background="{DynamicResource LauncherSurface}" Padding="32" HorizontalAlignment="Center" VerticalAlignment="Center" Width="420">
                <StackPanel Spacing="16">
                    <TextBlock Text="Mise à jour disponible" FontSize="20" FontWeight="SemiBold" />
                    <TextBlock Text="{Binding PendingUpdate.Version}" FontSize="16" FontWeight="Bold" />
                    <TextBlock Text="{Binding PendingUpdate.Notes}" TextWrapping="Wrap" />
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                        <Button Content="Plus tard" Command="{Binding CloseUpdateCommand}" Style="{DynamicResource SecondaryButtonStyle}" />
                        <Button Content="Télécharger" Command="{Binding DownloadUpdateCommand}" Style="{DynamicResource PrimaryButtonStyle}" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </Border>
    </Grid>
</UserControl>
